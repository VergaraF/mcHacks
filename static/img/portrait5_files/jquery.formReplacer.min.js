/* You need to buy a licence in order to use this script
 * http://codecanyon.net/item/formreplacer-fully-customize-your-form-elements/125515 */

(function($){$.fn.formReplacer=function(options){var defaultOptions={rtl:false},opts=$.extend(defaultOptions,options),defaults={tabIndex:0,prevTabIndex:0},checkbox={lastClicked:{},checkAll:true},arrow={left:37,up:38,right:39,down:40},supportedTypes={'radio':{'create':createCheckboxRadio,'events':{'click':evtRadioClick,'keypress':evtRadioCheckboxKeypress}},'checkbox':{'create':createCheckboxRadio,'events':{'click':evtCheckboxClick,'mousedown':preventTextSelection,'keypress':evtRadioCheckboxKeypress}},'select-one':{'create':createSelect,'events':{'click':evtSelectClick,'keydown':evtSelectKeydown,'keypress':operaPreventDefault}},'select-multiple':{'create':createSelectMultiple,'events':{'mousedown':preventTextSelection,'keypress':operaPreventDefault,'focus':preventTextSelection,'keydown':evtSelectMultipleKeydown}}};function evtRadioClick(e){e.preventDefault();$('.fReplacedRadio').filter(function(){return $(this).data('name')===e.data.obj.newObj.data('name');}).removeClass('selected');$(':radio[name="'+e.data.obj.newObj.data('name')+'"]').each(function(){$(this).prop('checked',false);});e.data.obj.old.filter('[value="'+e.data.obj.newObj.data('value')+'"]').prop('checked',true);e.data.obj.newObj.addClass('selected');}
function evtRadioCheckboxKeypress(e){e.which=e.which||e.keyCode;if(e.which===32){$(this).click();return false;}}
function selectCheckboxes(elements,toggle,select){var toCheck;elements.each(function(){toCheck=(toggle)?!$(this).hasClass('selected'):select;$(this).toggleClass('selected',toCheck);$(':checkbox[name="'+$(this).data('name')+'"][value="'+$(this).data('value')+'"]').prop('checked',toCheck);});}
function evtCheckboxClick(e){e.preventDefault();cancelOutline($(this));var sameNameCheckboxes=$('.fReplacedCheckbox').filter(function(){return($(this).data('name')===e.data.obj.nameAttr&&!$(this).data('disabled'));}),thisIndex=sameNameCheckboxes.index($(this));if(!checkbox.lastClicked[e.data.obj.nameAttr]){checkbox.lastClicked[e.data.obj.nameAttr]=null;}
if(e.shiftKey){if(checkbox.lastClicked[e.data.obj.nameAttr]===null){selectCheckboxes(sameNameCheckboxes.filter(':lt('+thisIndex+')').andSelf(),false,true);selectCheckboxes(sameNameCheckboxes.filter(':gt('+thisIndex+')'),false,false);}else{var lastClickedIndex=sameNameCheckboxes.index(checkbox.lastClicked[e.data.obj.nameAttr]),start=(lastClickedIndex<=thisIndex)?lastClickedIndex:thisIndex,end=(lastClickedIndex<=thisIndex)?thisIndex+1:lastClickedIndex+1,checkboxRange=sameNameCheckboxes.slice(start,end);selectCheckboxes(checkboxRange,false,true);selectCheckboxes(sameNameCheckboxes.not(checkboxRange),false,false);}}else{checkbox.lastClicked[e.data.obj.nameAttr]=$(this);selectCheckboxes($(this),true,false);}}
function createCheckboxRadio(obj){obj.newObj=$('<span class="fReplaced'+obj.className+' '+obj.existingClasses+'" id="'+obj.existingIDs+'" tabindex="'+assignTabIndex(obj.old)+'"></span>');obj.elemImgObj=$('<span class="fReplaced'+obj.className+'Img"></span>');obj.newObj.data('name',obj.nameAttr);obj.newObj.data('value',obj.old.prop('value'));obj.newObj.data('disabled',obj.old.is(':disabled'));obj.newObj.toggleClass('selected',obj.old.is(':checked'));obj.newObj.toggleClass('disabled',obj.newObj.data('disabled'));obj.old.after(obj.newObj);obj.newObj.append(obj.elemImgObj).append(obj.label);}
function evtSelectClick(e){e.stopPropagation();cancelOutline($(this));e.data.obj.newOptions.css({'position':'absolute','top':e.data.obj.newObj.offset().top+e.data.obj.newObj.outerHeight()-1,'left':(opts.rtl)?e.data.obj.newObj.offset().left+e.data.obj.newObj.outerWidth()-e.data.obj.newOptions.outerWidth():e.data.obj.newObj.offset().left,'zIndex':'9999'});e.data.obj.newOptions.slideToggle();}
function evtSelectKeydown(e){var lis=e.data.obj.newOptions.children(),liCount=lis.length,curLi=lis.filter(function(){return $(this).data('value')===e.data.obj.old.val();});e.which=e.which||e.keyCode;if(e.which===arrow.right||e.which===arrow.down){var nextLi=curLi.next();if((lis.index(curLi)+1)!==liCount){while(nextLi.data('disabled')||nextLi.hasClass('fReplacedOptGroup')){nextLi=nextLi.next();}
nextLi.click();}
return false;}else if(e.which===arrow.left||e.which===arrow.up){var prevLi=curLi.prev();if(lis.index(curLi)!==0){while(prevLi.data('disabled')||prevLi.hasClass('fReplacedOptGroup')){prevLi=prevLi.prev();}
prevLi.click();}
return false;}}
function evtSelectDocumentClick(e){if(!$(e.target).parents('.fReplacedSelectOptions').length){$('.fReplacedSelectOptions').slideUp();}}
function createSelect(obj){obj.newObj=$('<span class="fReplacedSelect'+" "+obj.existingClasses+'" id="'+obj.existingIDs+'" tabindex="'+assignTabIndex(obj.old)+'"></span>');obj.options=obj.old.children('option');obj.hasOptGroups=!!obj.old.has('optgroup').length;obj.optGroups=(obj.hasOptGroups)?obj.old.children('optgroup'):null;obj.currentOption=(obj.hasOptGroups)?obj.old.find('option:selected').text():obj.options.filter(':selected').text();obj.newOptions=$('<ul class="fReplacedSelectOptions"></ul>').hide();obj.newObj.data('name',obj.nameAttr);obj.newOptions.data('name',obj.nameAttr);obj.newObj.data('disabled',obj.old.is(':disabled'));obj.newObj.toggleClass('disabled',obj.newObj.data('disabled'));if(!obj.newObj.data('disabled')){$(document).off('click',evtSelectDocumentClick);$(document).on('click',{obj:obj},evtSelectDocumentClick);obj.newOptions.delegate('li','click',function(e){if(!$(e.target).hasClass('fReplacedOptGroup')&&!$(e.target).data('disabled')){obj.newOptions.slideUp();obj.newObj.html($(this).html());obj.old.val($(this).data('value'));}});}
if(obj.hasOptGroups){obj.optGroups.each(function(){var optGroup=$('<li id="'+$(this).attr('id')+'" class="fReplacedOptGroup'+' '+$(this).attr('class')+'">'+$(this).attr('label')+'</li>');obj.newOptions.append(optGroup);$(this).children('option').each(function(i,option){var text=($(option).text()!=='')?$(option).text():'&nbsp;',classes=$(option).attr('class'),disabledClass=$(option).is(':disabled')?'disabled':'',li=$('<li/>',{"class":classes+' '+disabledClass,"id":$(option).attr('id'),"text":text}).data('value',$(option).val()).data('disabled',$(option).is(':disabled'));obj.newOptions.append(li);});});}else{obj.options.each(function(i,option){var text=($(option).text()!=='')?$(option).text():'&nbsp;',classes=$(option).attr('class'),disabledClass=$(option).is(':disabled')?'disabled':'',li=$('<li/>',{"class":classes+' '+disabledClass,"id":$(option).attr('id'),"text":text}).data('value',$(option).val()).data('disabled',$(option).is(':disabled'));obj.newOptions.append(li);});}
if(jQuery.browser.msie){if(parseInt(jQuery.browser.version,10)<=6){obj.newOptions.children('li').css('width',obj.newOptions.width());}}
var value=(obj.currentOption!=='')?obj.currentOption:'&nbsp;';obj.newObj.html(value).insertAfter(obj.old).after(obj.newOptions);}
var position=0,currIndex=null;function evtSelectMultipleKeydown(e){cancelTextSelection();e.which=e.which||e.keyCode;var event=$.Event('click'),currentlySelected=$(this).children('li').filter(function(){return e.data.obj.old.children('option[value="'+$(this).data('value')+'"]').is(':selected');});event.shiftKey=true;if(e.which===32){toggleSelection($(this).children('li').filter(function(){return $(this).data('outlined')===true;}),e.data.obj.old);return false;}
if(e.which===arrow.right||e.which===arrow.down){var next=(currentlySelected.length===0)?$(this).children('li:first'):currentlySelected.filter(':last').next();while(next.data('disabled')){next=next.next();}
if(e.shiftKey){if(position>0){toggleSelection(currentlySelected.filter(':first'),e.data.obj.old);}else{next.trigger(event);}
if(!currentlySelected.filter($(this).children('li:not(.disabled):last')).length){position--;}}else if(e.ctrlKey){cancelOutline($(this).children('li'));if(currIndex===null){currIndex=0;}
$(this).children('li:not(.disabled)').eq(currIndex).data('outlined',true).css('outline','#fff dotted thin');currIndex=(currIndex<$(this).children('li:not(.disabled)').length-1)?++currIndex:currIndex;}else{cancelOutline($(this).children('li'));position=0;if($(this).children('li:not(.disabled)').index(currentlySelected.filter(':last'))!==($(this).children('li:not(.disabled)').length-1)){next.click();currIndex=$(this).children('li:not(.disabled)').index(next);}else{$(this).children('li:not(.disabled):last').click();currIndex=$(this).children('li:not(.disabled)').length-1;}}
return false;}else if(e.which===arrow.left||e.which===arrow.up){var prev=(currentlySelected.length===0)?$(this).children('li:first'):currentlySelected.filter(':first').prev();while(prev.data('disabled')){prev=prev.prev();}
if(e.shiftKey){if(position<0){toggleSelection(currentlySelected.filter(':last'),e.data.obj.old);}else{prev.trigger(event);}
if(!currentlySelected.filter($(this).children('li:not(.disabled):first')).length){position++;}}else if(e.ctrlKey){position++;currIndex=(currIndex>0)?--currIndex:currIndex;cancelOutline($(this).children('li'));$(this).children('li:not(.disabled)').eq(currIndex).data('outlined',true).css('outline','#fff dotted thin');}else{cancelOutline($(this).children('li'));position=0;if($(this).children('li:not(.disabled)').index(currentlySelected.filter(':first'))!==0){prev.click();currIndex=$(this).children('li:not(.disabled)').index(prev);}else{$(this).children('li:not(.disabled):first').click();currIndex=$(this).children('li:not(.disabled)').index('li:not(.disabled):first');}}
return false;}}
function createSelectMultiple(obj){obj.newObj=$('<ul id="'+obj.existingIDs+'" class="fReplacedSelectMultiple'+' '+obj.existingClasses+'" tabindex="'+assignTabIndex(obj.old)+'"></ul>').data('name',obj.old.attr('name'));obj.newObj.data('disabled',obj.old.is(':disabled'));obj.newObj.toggleClass('disabled',obj.newObj.data('disabled'));obj.options=obj.old.children('option');obj.selectedOptions=obj.old.children('option:selected');obj.lastClicked=null;obj.options.each(function(i,option){var text=($(option).text()!=='')?$(option).text():'&nbsp;',li=$('<li/>',{'class':$(option).attr('class'),'id':$(option).attr('id'),'text':text}).data('value',$(option).val()).data('disabled',$(option).is(':disabled'));li.toggleClass('selected',$(option).is(':selected'));li.toggleClass('disabled',li.data('disabled'));obj.newObj.append(li);});if(!obj.newObj.data('disabled')){obj.newObj.delegate('li','click',function(e){if(!$(e.target).data('disabled')){cancelOutline(obj.newObj);if(e.shiftKey){if(obj.lastClicked===null){obj.old.children('option[value="'+$(this).data('value')+'"]').prevAll().andSelf().filter(function(){return $(this).prop('disabled')===false;}).prop('selected',true);$(this).prevAll().andSelf().filter(function(){return $(this).data('disabled')===false;}).addClass('selected');obj.old.children('option[value="'+$(this).data('value')+'"]').nextAll().prop('selected',false);$(this).nextAll().removeClass('selected');}else{var start=(obj.lastClicked.index()<=$(this).index())?obj.lastClicked.index():$(this).index(),end=(obj.lastClicked.index()<=$(this).index())?$(this).index()+1:obj.lastClicked.index()+1,liRange=$(this).siblings().andSelf().slice(start,end),optionRange=obj.old.children('option').slice(start,end);optionRange.filter(function(){return $(this).prop('disabled')===false;}).prop('selected',true);liRange.filter(function(){return $(this).data('disabled')===false;}).addClass('selected');obj.old.children('option').not(optionRange).prop('selected',false);$(this).siblings().not(liRange).removeClass('selected');}}else{obj.lastClicked=$(this);var oldOption=obj.old.children('option[value="'+$(this).data('value')+'"]');if(e.ctrlKey){var selected=oldOption.is(':selected');oldOption.prop('selected',!selected);$(this).toggleClass('selected',!selected);}else{oldOption.prop('selected',true);$(this).addClass('selected');oldOption.siblings().prop('selected',false);$(this).siblings().removeClass('selected');}}}});}
obj.newObj.insertAfter(obj.old);obj.newObj.css('width',obj.newObj.width()+20);}
var Element=(function(){var Element=function(type,oldElement){this.className=type.replace(/^./,type.match(/^./)[0].toUpperCase());this.elemType=type;this.old=$(oldElement).hide();this.existingClasses=$(oldElement).attr('class')?$(oldElement).attr('class'):'';this.existingIDs=$(oldElement).attr('id')?$(oldElement).attr('id'):'';this.nameAttr=$(this.old).attr('name');this.label=$('label[for="'+$(this.old).attr('id')+'"]');supportedTypes[this.elemType].create(this);if(!this.newObj.data('disabled')){this.newObj.on(supportedTypes[this.elemType]['events'],{obj:this});}};return function(type,oldElement){return new Element(type,oldElement);};})();this.each(function(){if(this.type in supportedTypes){var elem=new Element(this.type,this);handleOutline(elem.newObj);}});function cancelTextSelection(){if($.browser.msie){document.selection.empty();}else if($.browser.opera&&parseInt($.browser.version,10)===9){}else{window.getSelection().removeAllRanges();}}
function preventTextSelection(e){var result=e.shiftKey||e.ctrlKey;if(result){cancelTextSelection();}
this.onselectstart=function(){return!result;};return!result;}
function operaPreventDefault(e){e.which=e.which||e.keyCode;if(e.which===32||e.which===arrow.up||e.which===arrow.down||e.which===arrow.right||e.which===arrow.left){return false;}}
function cancelOutline(elem){elem.css('outline','none').data('outlined',false);}
function handleOutline(elem){elem.css('outline','none');elem.focusout(function(){$(this).css('outline','none');});elem.keyup(function(e){e.which=e.which||e.keyCode;if(e.which===9){$(this).css('outline','#fff dotted thin');}});}
function assignTabIndex(el){defaults.tabIndex=(el.attr('tabindex'))?el.attr('tabindex'):++defaults.prevTabIndex;defaults.prevTabIndex=defaults.tabIndex;return defaults.tabIndex;}
function toggleSelection(elem,oldElem){elem.each(function(){if(oldElem.children('option[value="'+elem.data('value')+'"]').prop('selected')===true){elem.removeClass('selected');oldElem.children('option[value="'+elem.data('value')+'"]').prop('selected',false);}else{elem.addClass('selected');oldElem.children('option[value="'+elem.data('value')+'"]').prop('selected',true);}});}
$('.checkAll').click(function(){var names=$(this).attr('class').replace(/(checkAll\s)(.*)/,"$2").split(' '),affected=0,checked=0,sameNameGroup=null;for(var name in names){sameNameGroup=$('.fReplacedCheckbox').filter(function(){return($(this).data('name')===names[name]&&!$(this).hasClass('disabled'));});sameNameGroup.each(function(){affected++;if($(':checkbox[value="'+$(this).data('value')+'"]').is(':checked')){checked++;}});if((affected==checked)&&checkbox.checkAll){checkbox.checkAll=false;}
if((checked===0)&&!checkbox.checkAll){checkbox.checkAll=true;}
sameNameGroup.each(function(){$(this).toggleClass('selected',checkbox.checkAll);$(':checkbox[value="'+$(this).data('value')+'"]').prop('checked',checkbox.checkAll);});}
checkbox.checkAll=!checkbox.checkAll;return false;});return this;};})(jQuery);
